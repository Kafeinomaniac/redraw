{"version":3,"sources":["chart-test.min.js"],"names":["root","factory","exports","module","define","amd","this","modules","__webpack_require__","moduleId","installedModules","id","loaded","call","m","c","p","_interopRequireDefault","obj","__esModule","default","_classCallCheck","instance","Constructor","TypeError","dataURItoBlob","encodedData","decodedData","atob","split","array","i","length","push","charCodeAt","Blob","Uint8Array","type","getToolsFromUserSettings","allTools","options","tools","definedTools","t","toolName","overwriteProps","allProps","precedenceProps","globalOptions","results","hasOwnProperty","globalOverrides","indexOf","_createClass","defineProperties","target","props","descriptor","enumerable","configurable","writable","Object","defineProperty","key","protoProps","staticProps","prototype","_browserApi","_browserApi2","_canvasWrapper","_canvasWrapper2","_eventAggregator","_eventAggregator2","_controlsDispatcher","_controlsDispatcher2","redrawNs","Redraw","imgElement","events","_canvas","jsonContent","loadFromJSON","controls","initializeTools","value","canvas","deactivateAllWithDispatch","toDataURL","format","multiplier","scale","getDataUrlForExport","includeImage","cancelActiveTool","jsObj","toObject","backgroundImage","JSON","stringify","jsonRepresentation","getAllObjects","canvasIsDirty","topic","callbackFn","subscriberId","scope","subscribeTo","unsubscribeTo","toolSettings","toolsInUse","passedProps","toolFn","setupTools","canvasContainer","Annotation","registerTool","_name","_toolFn","_options","address","buttonCss","appendToWindow","isBrowser","window","Browser","document","attributeName","getFromWindow","setupListener","fabricCanvas","canvasWrapper","off","on","_canvasConst","_canvasConst2","Canvas","eventAggregator","parent","parentNode","createElement","className","CSS","PARENT","insertBefore","removeChild","canvasElem","appendChild","canvasLeft","offsetLeft","fabric","theCanvas","delayedSetup","setupImage","tmp","Image","addEventListener","src","getBinder","renderAll","event","notify","image","maxWidth","width","maxHeight","height","scaleY","setDimensions","setScaleX","setScaleY","setBackgroundImage","_scaleY","subscriptionId","sender","status","defaultCursor","clear","bind","offsetTop","getObjects","isEnabled","selection","forEachObject","o","selectable","TOOL","ARROW","BOX","PIXELATE","CLEAR","DUMP","HLINE","REMOVE","TEXT","DEFAULT_COLOR","TOOLBAR","BUTTON","ACTIVE_BUTTON","EventAggregator","subscriptionsByTopic","onNotifyFn","_invokationScope","subscriber","invokationScope","_subscriber","j","splice","payload","s2","undefined","apply","addClasses","btnObj","classes","allClasses","forEach","clazz","classList","add","ControlsDispatcher","notifyActive","activeTool","manageKeys","e","keyCode","domParent","mainOptions","container","toolbarCss","toolbarFirst","firstChild","btn","innerHTML","label","onclick","btnActiveCss","buttonActiveCss","currTool","remove","line","indicationLength","ArrowTool","toolOptions","console","log","arrow","start","end","callee","initListeners","arguments","moveFn","onMove","downFn","onMouseDown","upFn","onMUP","message","done","enableSelection","removeCanvasListeners","points","x1","y1","x2","y2","dx","dy","angle","Math","atan2","PI","Triangle","fill","activeColor","top","left","originX","originY","pointer","getPointer","set","x","y","moveArrowIndicator","perimeter","abs","color","group","Group","hasControls","hasBorders","stroke","Line","strokeWidth","abort","me","toolProps","rect","BoxTool","detachBoxListener","mouseDown","drawBox","drawBoxDone","currWidth","startLeft","currHeight","startTop","setCoords","opacity","Rect","borderColor","hasRotatingPoint","attachBoxListener","callbackCtx","defaultToolProps","PixelateTool","applyFilter","index","filter","filters","applyFilters","object","getContext","getImageData","util","clone","lockMovementX","lockMovementY","clipTo","ctx","render","f","Pixelate","blocksize","sendToBack","ResetTool","initClear","confirm","clearAllElements","all","HorizontalLineTool","createHorizontalLine","padding","_HorizontalLineTool","addr","action","horizontalLine","detachHorizontalLineListener","onMouseMove","onMouseUp","RemoveTool","getActiveObject","TextTool","editor","textTool","detachTextListener","IText","fontFamily","fontSize"],"mappings":"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","file":"chart-test.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"rechart\"] = factory();\n\telse\n\t\troot[\"rechart\"] = factory();\n})(this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t__webpack_require__(1);\n\t__webpack_require__(7);\n\t__webpack_require__(8);\n\t__webpack_require__(9);\n\t__webpack_require__(10);\n\t__webpack_require__(11);\n\t__webpack_require__(12);\n\tmodule.exports = __webpack_require__(13);\n\n\n/***/ },\n/* 1 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _browserApi = __webpack_require__(2);\n\t\n\tvar _browserApi2 = _interopRequireDefault(_browserApi);\n\t\n\tvar _canvasWrapper = __webpack_require__(3);\n\t\n\tvar _canvasWrapper2 = _interopRequireDefault(_canvasWrapper);\n\t\n\tvar _eventAggregator = __webpack_require__(5);\n\t\n\tvar _eventAggregator2 = _interopRequireDefault(_eventAggregator);\n\t\n\tvar _controlsDispatcher = __webpack_require__(6);\n\t\n\tvar _controlsDispatcher2 = _interopRequireDefault(_controlsDispatcher);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\t/**\n\t * Namespace-root, that will be set to window-Object.\n\t * @access private\n\t */\n\tvar redrawNs = {\n\t    tools: {}\n\t};\n\t\n\t/**\n\t * Makes a blob from eg base64-string.\n\t * @access private\n\t * @param data {string} encodedData - to encode\n\t * @returns {Blob} results\n\t */\n\tfunction dataURItoBlob(encodedData) {\n\t    var decodedData = atob(encodedData.split(',')[1]);\n\t    var array = []; // 8-bit unsigned array\n\t    for (var i = 0; i < decodedData.length; i++) {\n\t        array.push(decodedData.charCodeAt(i));\n\t    }\n\t    return new Blob([new Uint8Array(array)], {\n\t        type: 'image/png'\n\t    });\n\t}\n\t\n\t/**\n\t * If the user has defined the options.tools, then use this to\n\t * extract the sepcified subset from allTools.\n\t * @access private\n\t * @param {Object[]} allTools - should be tools to pick from.\n\t * @param {Object} options - with or without property tools.\n\t * @returns {Object} containing all or the selected tools.\n\t */\n\tfunction getToolsFromUserSettings(allTools, options) {\n\t\n\t    if (options && options.tools) {\n\t        var definedTools = {};\n\t        for (var t in options.tools) {\n\t            var toolName = options.tools[t];\n\t            definedTools[toolName] = allTools[toolName];\n\t        }\n\t        return definedTools;\n\t    } else {\n\t        return allTools;\n\t    }\n\t}\n\t\n\t/**\n\t * Defines the options-properties allowed to infect all tools-settings.\n\t * @access private\n\t */\n\tvar globalOverrides = ['color', 'activeColor'];\n\t\n\t/**\n\t * Figures out which options should be applied for a particular toolName.\n\t * @access private\n\t * @param {Object} allProps - already defined options, that shold not be lost, but perhaps\n\t * replaced if defined in precedenceProps or globalOptions.\n\t * @param {Object} precedenceProps - that may have a property named toolName, that will\n\t * replace options from allProps.\n\t * @param {Object} globalOptions - top-level options that will overwrite allProp but not precedenceProps \n\t * @param {string} toolName - name of the tool, which options is processed\n\t * @returns {Object} with tool applies options\n\t */\n\tfunction overwriteProps(allProps, precedenceProps, globalOptions, toolName) {\n\t    var results = {};\n\t\n\t    for (var p in allProps[toolName].options) {\n\t        if (allProps[toolName].options.hasOwnProperty(p)) {\n\t            if (precedenceProps[toolName] && precedenceProps[toolName] && precedenceProps[toolName].hasOwnProperty(p)) {\n\t                results[p] = precedenceProps[toolName][p];\n\t            } else if (globalOverrides.indexOf(p) > -1 && globalOptions.hasOwnProperty(p)) {\n\t                results[p] = globalOptions[p];\n\t            } else {\n\t                results[p] = allProps[toolName].options[p];\n\t            }\n\t        }\n\t    }\n\t    return results;\n\t}\n\t\n\t/**\n\t * Main module, and the only public api for usage.\n\t * @module redraw\n\t */\n\t\n\tvar Redraw = function () {\n\t    /**\n\t     * Redraw constructor. Bootstraps the canvas and tools.\n\t     * @constructor\n\t     * @param {Object} imgElement - The dom element that holds the image.\n\t     * @param {Object} options - Options.\n\t     */\n\t\n\t    function Redraw(imgElement, options) {\n\t        _classCallCheck(this, Redraw);\n\t\n\t        this.events = new _eventAggregator2.default();\n\t        options = options || {};\n\t        this._canvas = new _canvasWrapper2.default(imgElement, this.events, options); // Needs defactor\n\t\n\t        if (options.jsonContent) {\n\t            this._canvas.loadFromJSON(options.jsonContent);\n\t        }\n\t\n\t        this.controls = this.initializeTools(this.events, options);\n\t    }\n\t    /**\n\t     * Get the png-representation of the canvas.\n\t     * @access public\n\t     * @returns {string} with base64 encoded png.\n\t     */\n\t\n\t\n\t    _createClass(Redraw, [{\n\t        key: 'getDataUrlForExport',\n\t        value: function getDataUrlForExport() {\n\t            this._canvas.canvas.deactivateAllWithDispatch();\n\t            return this._canvas.canvas.toDataURL({\n\t                format: 'png',\n\t                multiplier: 1 / this._canvas.scale\n\t            });\n\t        }\n\t\n\t        /**\n\t         * Get the base64-encoded png-representation of the canvas.\n\t         * @access public\n\t         * @returns {string} with base64 encoded png.\n\t         */\n\t\n\t    }, {\n\t        key: 'toBase64URL',\n\t        value: function toBase64URL() {\n\t            return this.getDataUrlForExport();\n\t        }\n\t\n\t        /**\n\t         * Get the binary png-representation of the canvas.\n\t         * @access public\n\t         * @returns {Blob} with canvas as png.\n\t         */\n\t\n\t    }, {\n\t        key: 'toDataBlob',\n\t        value: function toDataBlob() {\n\t            return dataURItoBlob(this.getDataUrlForExport());\n\t        }\n\t\n\t        /**\n\t         * Get the json-representation of the canvas.\n\t         * @access public\n\t         * @param {boolean} includeImage - true if background-image should be included in the json.\n\t         * @returns {string} with json.\n\t         */\n\t\n\t    }, {\n\t        key: 'toJson',\n\t        value: function toJson(includeImage) {\n\t            this.controls.cancelActiveTool();\n\t            var jsObj = this._canvas.canvas.toObject(['lockMovementX', 'lockMovementY', 'lockRotation', 'lockScalingX', 'lockScalingY', 'lockUniScaling', 'hasControls', 'hasRotatingPoint', 'selectable', 'fill', 'padding']);\n\t\n\t            if (!includeImage) {\n\t                delete jsObj.backgroundImage;\n\t            }\n\t            return JSON.stringify(jsObj);\n\t        }\n\t\n\t        /**\n\t         * Resets image and loads content from provided json.\n\t         * @access public\n\t         * @param {string} jsonRepresentation - to provide as current state of the canvas.\n\t         */\n\t\n\t    }, {\n\t        key: 'fromJson',\n\t        value: function fromJson(jsonRepresentation) {\n\t            this._canvas.loadFromJSON(jsonRepresentation);\n\t        }\n\t\n\t        /**\n\t         * Tells whether or not any objects are present in the canvas, i.e. arrows, boxes other than the image itself.\n\t         * @access public\n\t         * @returns {boolean} true if there are obejcts, i.e.\n\t         */\n\t\n\t    }, {\n\t        key: 'isEmpty',\n\t        value: function isEmpty() {\n\t            return this._canvas.getAllObjects().length === 0;\n\t        }\n\t    }, {\n\t        key: 'isDirty',\n\t        value: function isDirty() {\n\t            return this._canvas.canvasIsDirty;\n\t        }\n\t\n\t        /**\n\t         * Returns the canvas representation, as is from Fabric.js\n\t         * @access public\n\t         * @returns {Object} canvas, see http://fabricjs.com/.\n\t         */\n\t\n\t    }, {\n\t        key: 'getCanvas',\n\t        value: function getCanvas() {\n\t            return this._canvas.canvas;\n\t        }\n\t    }, {\n\t        key: 'on',\n\t        value: function on(topic, callbackFn, subscriberId, scope) {\n\t            this.events.subscribeTo(topic, 'cx-' + subscriberId, callbackFn, scope);\n\t        }\n\t    }, {\n\t        key: 'off',\n\t        value: function off(topic, subscriberId) {\n\t            this.events.unsubscribeTo(topic, 'cx-' + subscriberId);\n\t        }\n\t\n\t        /**\n\t         * Initializes all selected tools.\n\t         * @param {EventAggregator} events - used for all mediated communications.\n\t         * @param {Object} options - settings for all tools.\n\t         */\n\t\n\t    }, {\n\t        key: 'initializeTools',\n\t        value: function initializeTools(events, options) {\n\t            var localToolSettings = {};\n\t            options.toolSettings = options.toolSettings || {};\n\t            var toolsInUse = getToolsFromUserSettings(redrawNs.tools, options);\n\t\n\t            for (var toolName in toolsInUse) {\n\t                var passedProps = overwriteProps(redrawNs.tools, options.toolSettings, options, toolName);\n\t\n\t                redrawNs.tools[toolName].options = passedProps;\n\t\n\t                new redrawNs.tools[toolName].toolFn(this._canvas, events, passedProps);\n\t            }\n\t            var controls = new _controlsDispatcher2.default(events, options);\n\t            controls.setupTools(toolsInUse, this._canvas.canvasContainer, options);\n\t            return controls;\n\t        }\n\t    }]);\n\t\n\t    return Redraw;\n\t}();\n\t\n\tredrawNs.Annotation = Redraw;\n\t/**\n\t * Used by tools to register themselves to be available for usage.\n\t * @access public\n\t * @param {string} _name - name of tool.\n\t * @param {function(canvas: CanvasWrapper, events: EventAggregator, passedProps: Object)} _toolFn - callback function, invoked upon initialization of the tools.\n\t * @param {Object} _options - options, to be used as default ones.\n\t */\n\tredrawNs.registerTool = function (_name, _toolFn, _options) {\n\t    redrawNs.tools[_name] = {\n\t        address: _name,\n\t        toolFn: _toolFn,\n\t        options: _options\n\t    };\n\t    // buttonCss is an attribute that applies to all tools\n\t    redrawNs.tools[_name].options.buttonCss = redrawNs.tools[_name].options.buttonCss || '';\n\t};\n\t\n\tnew _browserApi2.default().appendToWindow('redraw', redrawNs);\n\n/***/ },\n/* 2 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar isBrowser = typeof window !== 'undefined';\n\t\n\t/**\n\t * Facade of the browser apis. The main purpose id to facilitate testing.\n\t */\n\t\n\tvar Browser = function () {\n\t    /**\n\t     * Contructor that determines if there is a browser present.\n\t     * @constructor\n\t     */\n\t\n\t    function Browser() {\n\t        _classCallCheck(this, Browser);\n\t\n\t        this.document = isBrowser ? document : {};\n\t        this.window = isBrowser ? window : {};\n\t    }\n\t\n\t    /**\n\t     * Appends property to the browser window object.\n\t     * @param {string} attributeName - Name of the property to create/assign.\n\t     * @param {Object} obj - value to set.\n\t     */\n\t\n\t\n\t    _createClass(Browser, [{\n\t        key: 'appendToWindow',\n\t        value: function appendToWindow(attributeName, obj) {\n\t\n\t            if (isBrowser) {\n\t                window[attributeName] = obj;\n\t                return true;\n\t            }\n\t            return false;\n\t        }\n\t\n\t        /**\n\t         * Use to retrieve property from the browser window object.\n\t         * @param {string} attributeName - Name of the property to create/assign.\n\t         * @returns {Object} obj - retrieved value, or mock if not browser.\n\t         */\n\t\n\t    }, {\n\t        key: 'getFromWindow',\n\t        value: function getFromWindow(attributeName) {\n\t            if (window) {\n\t                return window[attributeName];\n\t            }\n\t            return {\n\t                getFromWindow: function getFromWindow() {},\n\t                tools: [] };\n\t        }\n\t    }]);\n\t\n\t    return Browser;\n\t}();\n\n\texports.default = Browser;\n\n/***/ },\n/* 3 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _canvasConst = __webpack_require__(4);\n\t\n\tvar _canvasConst2 = _interopRequireDefault(_canvasConst);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\t/**\n\t* Gets the scroll position of a dom element.\n\t* @access private\n\t* @param {Object} elem - target element.\n\t*/\n\tfunction scrollPosition(elem) {\n\t    var left = 0,\n\t        top = 0;\n\t\n\t    do {\n\t        left += elem.scrollLeft;\n\t        top += elem.scrollTop;\n\t    } while (elem = elem.offsetParent);\n\t\n\t    return [left, top];\n\t}\n\t\n\tfunction setupListener(fabricCanvas, canvasWrapper) {\n\t    function canvasIsDirty() {\n\t        canvasWrapper.canvasIsDirty = true;\n\t        fabricCanvas.off('object:added', canvasIsDirty);\n\t        fabricCanvas.off('object:selected', canvasIsDirty);\n\t    }\n\t    fabricCanvas.off('object:added', canvasIsDirty);\n\t    fabricCanvas.off('object:selected', canvasIsDirty);\n\t    canvasWrapper.canvasIsDirty = false;\n\t\n\t    fabricCanvas.on('object:added', canvasIsDirty);\n\t    fabricCanvas.on('object:selected', canvasIsDirty);\n\t}\n\t/**\n\t * Canvas object that facilitates \n\t */\n\t\n\tvar Canvas = function () {\n\t    /**\n\t    * Tools contructor. Is provided with canvas-wrapper and eventAggregator by contract.\n\t    * @constructor\n\t    * @param {Object} imgElement - dom element that will be replaced and\n\t    * used as background for canvas.\n\t    * @param {EventAggregator} eventAggregator - Event mediator.\n\t    * @param {Object} options - parameters used to setup looks and all tools preferences.\n\t    */\n\t\n\t    function Canvas(imgElement, eventAggregator, options) {\n\t        _classCallCheck(this, Canvas);\n\t\n\t        this.options = options;\n\t        this.eventAggregator = eventAggregator;\n\t        var parent = imgElement.parentNode;\n\t        var canvasWrapper = document.createElement(\"div\");\n\t        canvasWrapper.className = _canvasConst2.default.CSS.PARENT;\n\t        this.scale = 1;\n\t        parent.insertBefore(canvasWrapper, imgElement);\n\t        parent.removeChild(imgElement);\n\t\n\t        var canvasElem = document.createElement(\"canvas\");\n\t        canvasWrapper.appendChild(canvasElem);\n\t\n\t        this.canvasElem = canvasElem;\n\t\n\t        this.canvasContainer = canvasWrapper;\n\t        this.canvasLeft = canvasElem.offsetLeft;\n\t        this.canvas = new fabric.Canvas(canvasElem);\n\t        this.imgElement = imgElement;\n\t\n\t        /* wait until the image is surely loaded to make the setup */\n\t        var theCanvas = this;\n\t        var delayedSetup = function delayedSetup() {\n\t            theCanvas.setupImage();\n\t        };\n\t        var tmp = new Image();\n\t        tmp.addEventListener('load', delayedSetup, false);\n\t        tmp.src = this.imgElement.src;\n\t        setupListener(this.canvas, this);\n\t    }\n\t\n\t    _createClass(Canvas, [{\n\t        key: 'setupImage',\n\t        value: function setupImage() {\n\t            this.image = new fabric.Image(this.imgElement);\n\t            if (this.options.maxWidth && this.options.maxWidth < this.image.width) {\n\t                this.scale = this.options.maxWidth / this.image.width;\n\t            }\n\t            if (this.options.maxHeight && this.options.maxHeight < this.image.height) {\n\t                var scaleY = this.options.maxHeight / this.image.height;\n\t                if (this.scale > scaleY) {\n\t                    this.scale = scaleY;\n\t                }\n\t            }\n\t\n\t            this.width = this.scale * this.imgElement.width;\n\t            this.height = this.scale * this.imgElement.height;\n\t\n\t            this.canvas.setDimensions({\n\t                width: this.width,\n\t                height: this.height\n\t            });\n\t\n\t            this.image.setScaleX(this.scale);\n\t            this.image.setScaleY(this.scale);\n\t            var event = this.eventAggregator;\n\t            function getBinder(_canvas) {\n\t                return function () {\n\t                    _canvas.renderAll();\n\t                    event.notify('canvas-loaded', 'CANVAS');\n\t                };\n\t            }\n\t            this.canvas.setBackgroundImage(this.image, getBinder(this.canvas), {});\n\t\n\t            if (this.options.maxWidth && this.options.maxWidth < this.image.width) {\n\t                this.scale = this.options.maxWidth / this.image.width;\n\t            }\n\t            if (this.options.maxHeight && this.options.maxHeight < this.image.height) {\n\t                var _scaleY = this.options.maxHeight / this.image.height;\n\t                if (this.scale > _scaleY) {\n\t                    this.scale = _scaleY;\n\t                }\n\t            }\n\t\n\t            this.eventAggregator.subscribeTo('TOOL_USAGE', 'toolbar', function (subscriptionId, sender, status) {\n\t                if (status === 'active') {\n\t                    this.canvas.defaultCursor = 'crosshair';\n\t                } else {\n\t                    this.canvas.defaultCursor = 'default';\n\t                }\n\t            }, this);\n\t        }\n\t    }, {\n\t        key: 'loadFromJSON',\n\t        value: function loadFromJSON(jsonContent) {\n\t            this.canvas.clear();\n\t            this.canvas.loadFromJSON(jsonContent, this.canvas.renderAll.bind(this.canvas));\n\t            setupListener(this.canvas, this);\n\t        }\n\t\n\t        /**\n\t         * Gets the top position of the canvas dom element.\n\t         * @access public\n\t         * @returns {number} position in pixels?\n\t         */\n\t\n\t    }, {\n\t        key: 'getCanvasTop',\n\t        value: function getCanvasTop() {\n\t            return this.canvasContainer.offsetTop;\n\t        }\n\t\n\t        /**\n\t         * Gets the array of all objects of the canvas.\n\t         * @access public\n\t         * @returns {Array} with canvas object, or undefined if empty.\n\t         */\n\t\n\t    }, {\n\t        key: 'getAllObjects',\n\t        value: function getAllObjects() {\n\t            return this.canvas.getObjects();\n\t        }\n\t\n\t        /**\n\t         * Set/unset whether or not it is possible to select objects of the canvas.\n\t         * @access pulic\n\t         * @param {boolean} isEnabled - true if selection is enabled, false otherwise.\n\t         */\n\t\n\t    }, {\n\t        key: 'enableSelection',\n\t        value: function enableSelection(isEnabled) {\n\t            this.canvas.selection = isEnabled; // Restore fabricjs selection-box\n\t            this.canvas.forEachObject(function (o) {\n\t                o.selectable = isEnabled;\n\t            });\n\t        }\n\t    }]);\n\t\n\t    return Canvas;\n\t}();\n\n\texports.default = Canvas;\n\n/***/ },\n/* 4 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\texports.default = {\n\t\tTOOL: {\n\t\t\tARROW: 'arrow',\n\t\t\tBOX: 'box',\n\t\t\tPIXELATE: 'pixel',\n\t\t\tCLEAR: 'clear',\n\t\t\tDUMP: 'dump',\n\t\t\tHLINE: 'hline',\n\t\t\tREMOVE: 'delete',\n\t\t\tTEXT: 'text'\n\t\t},\n\t\tDEFAULT_COLOR: '#33e',\n\t\tCSS: {\n\t\t\tPARENT: 'redraw_parent',\n\t\t\tTOOLBAR: 'redraw_toolbar',\n\t\t\tBUTTON: 'redraw_btn',\n\t\t\tACTIVE_BUTTON: 'active'\n\t\t}\n\t};\n\n/***/ },\n/* 5 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\t/**\n\t* Mediator for events.\n\t*/\n\t\n\tvar EventAggregator = function () {\n\t    /**\n\t     * Contructor that initializes internal stuff.\n\t     * @constructor\n\t     */\n\t\n\t    function EventAggregator() {\n\t        _classCallCheck(this, EventAggregator);\n\t\n\t        this.subscriptionsByTopic = {};\n\t    }\n\t\n\t    /**\n\t     * Registers a subscriber for a specific event topic.\n\t     * @param {string} topic - name of the event type / topic.\n\t     * @param {string} subscriberId - id the subscriber, must be unique.\n\t     * @param {function(topic: string, sender: string, payload: Object)} onNotifyFn - callback\n\t     * invoked upon when upon notification.\n\t     * @param {Object} [_invokationScope] - scope to be used when invoking callback.\n\t     */\n\t\n\t\n\t    _createClass(EventAggregator, [{\n\t        key: \"subscribeTo\",\n\t        value: function subscribeTo(topic, subscriberId, onNotifyFn, _invokationScope) {\n\t            if (!this.subscriptionsByTopic[topic]) {\n\t                this.subscriptionsByTopic[topic] = [];\n\t            }\n\t\n\t            this.subscriptionsByTopic[topic].push({ subscriber: subscriberId, callbackFn: onNotifyFn, invokationScope: _invokationScope });\n\t        }\n\t\n\t        // ToDo needs test\n\t        /**\n\t         * Unregisters a subscriber from a specific event topic.\n\t         * @param {string} topic - name of the event type / topic.\n\t         * @param {string} _subscriber - id the unique subscriber.\n\t         */\n\t\n\t    }, {\n\t        key: \"unsubscribeTo\",\n\t        value: function unsubscribeTo(topic, _subscriber) {\n\t            for (var j in this.subscriptionsByTopic[topic]) {\n\t                if (this.subscriptionsByTopic[topic][j].subscriber === _subscriber) {\n\t                    this.subscriptionsByTopic[topic].splice(j, 1);\n\t                }\n\t            }\n\t        }\n\t\n\t        /**\n\t         * Called to notify all subscribers of this topic\n\t         * @param {string} topic - name of the event type / topic.\n\t         * @param {string} sender - address of the sender.\n\t         * @param {Object} payload - any data to pass to the subscriber.\n\t         */\n\t\n\t    }, {\n\t        key: \"notify\",\n\t        value: function notify(topic, sender, payload) {\n\t            for (var s2 in this.subscriptionsByTopic[topic]) {\n\t                var scope = undefined;\n\t                if (this.subscriptionsByTopic[topic][s2].invokationScope) {\n\t                    scope = this.subscriptionsByTopic[topic][s2].invokationScope;\n\t                }\n\t                this.subscriptionsByTopic[topic][s2].callbackFn.apply(scope, [topic, sender, payload]);\n\t            }\n\t        }\n\t    }]);\n\t\n\t    return EventAggregator;\n\t}();\n\n\texports.default = EventAggregator;\n\n/***/ },\n/* 6 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _canvasConst = __webpack_require__(4);\n\t\n\tvar _canvasConst2 = _interopRequireDefault(_canvasConst);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\t/**\n\t * Css class for all buttons of the toolbar.\n\t */\n\tvar BUTTON_CLASS = 'redraw_btn';\n\t\n\t/**\n\t * Adds a class to the array of classes.\n\t * @private\n\t */\n\tfunction addClasses(btnObj, classes) {\n\t    if (!classes) return;\n\t    var allClasses = classes.split(' ');\n\t\n\t    allClasses.forEach(function (clazz) {\n\t        btnObj.classList.add(clazz);\n\t    });\n\t}\n\t\n\t/**\n\t * Main manager for the toolbar.\n\t */\n\t\n\tvar ControlsDispatcher =\n\t/**\n\t * Controls contructor. Is provided with canvas-wrapper and options to initialize to toolbar.\n\t * @constructor\n\t * @param {EventAggregator} eventAggregator - Event mediator.\n\t * @param {Object} options - from user.\n\t */\n\tfunction ControlsDispatcher(eventAggregator, options) {\n\t    _classCallCheck(this, ControlsDispatcher);\n\t\n\t    this.toolsInUse = {};\n\t    var activeTool, delBtn;\n\t\n\t    function notifyActive(topic) {\n\t        return function () {\n\t            if (activeTool) {\n\t                eventAggregator.notify(activeTool, 'toolbar', 'toolbar-deactivate');\n\t            }\n\t            if (activeTool !== topic) {\n\t                activeTool = topic;\n\t                eventAggregator.notify(topic, 'toolbar', 'toolbar-click');\n\t            } else {\n\t                activeTool = undefined;\n\t            }\n\t        };\n\t    }\n\t\n\t    this.cancelActiveTool = function () {\n\t\n\t        if (activeTool) {\n\t            eventAggregator.notify(activeTool, 'toolbar', 'toolbar-deactivate');\n\t            activeTool = undefined;\n\t        }\n\t    };\n\t\n\t    var manageKeys = function manageKeys(e) {\n\t        if (e.keyCode === 46 || e.keyCode === 27) {\n\t            eventAggregator.notify('keydown', 'toolbar', e.keyCode);\n\t        }\n\t    };\n\t\n\t    window.addEventListener('keydown', manageKeys, false);\n\t\n\t    this.setupTools = function (tools, domParent, mainOptions) {\n\t        var container = document.createElement('div');\n\t\n\t        addClasses(container, _canvasConst2.default.CSS.TOOLBAR);\n\t        addClasses(container, options.toolbarCss);\n\t\n\t        if (mainOptions.toolbarFirst === true) {\n\t            domParent.insertBefore(container, domParent.firstChild);\n\t        } else {\n\t            domParent.appendChild(container);\n\t        }\n\t\n\t        for (var toolName in tools) {\n\t            var btn = document.createElement('button');\n\t            btn.innerHTML = tools[toolName].options.label;\n\t\n\t            btn.classList.add(_canvasConst2.default.CSS.BUTTON);\n\t\n\t            addClasses(btn, mainOptions.buttonCss);\n\t            addClasses(btn, tools[toolName].options.buttonCss);\n\t\n\t            btn.onclick = notifyActive(tools[toolName].address);\n\t            this.toolsInUse[tools[toolName].address] = btn;\n\t            container.appendChild(btn);\n\t        }\n\t\n\t        var btnActiveCss = mainOptions.buttonActiveCss || _canvasConst2.default.CSS.ACTIVE_BUTTON;\n\t\n\t        eventAggregator.subscribeTo('TOOL_USAGE', 'toolbar', function (subscriptionId, sender, status) {\n\t            var currTool = this.toolsInUse[sender];\n\t\n\t            if (status !== 'active') {\n\t                if (sender === activeTool) {\n\t                    activeTool = undefined;\n\t                }\n\t                currTool.classList.remove(btnActiveCss);\n\t            } else {\n\t                currTool.classList.add(btnActiveCss);\n\t            }\n\t        }, this);\n\t\n\t        eventAggregator.subscribeTo('tool-enabled', 'toolbar', function (subscriptionId, sender, isEnabled) {\n\t            if (isEnabled) {\n\t                this.toolsInUse[sender].classList.remove('disabled');\n\t            } else {\n\t                this.toolsInUse[sender].classList.add('disabled');\n\t            }\n\t        }, this);\n\t    };\n\t};\n\t\n\texports.default = ControlsDispatcher;\n\n/***/ },\n/* 7 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _canvasConst = __webpack_require__(4);\n\t\n\tvar _canvasConst2 = _interopRequireDefault(_canvasConst);\n\t\n\tvar _browserApi = __webpack_require__(2);\n\t\n\tvar _browserApi2 = _interopRequireDefault(_browserApi);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\t/** length of arrow head */\n\tvar indicationLength = 20;\n\t/** line used during drag n drop */\n\tvar line;\n\t\n\t/**\n\t * A tool to paint arrows.\n\t */\n\t\n\tvar ArrowTool = function () {\n\t    /**\n\t     * Tools contructor. Is provided with canvas-wrapper and eventAggregator by contract.\n\t     * @constructor\n\t     * @param {Canvas} canvasWrapper - Canvas.\n\t     * @param {EventAggregator} eventAggregator - Event mediator.\n\t     */\n\t\n\t    function ArrowTool(canvasWrapper, eventAggregator, toolOptions, fabric) {\n\t        _classCallCheck(this, ArrowTool);\n\t\n\t        console.log('##### alpha *******************');\n\t        /** eventAggregator for madiated cummunications */\n\t        this.eventAggregator = eventAggregator;\n\t        /** main api to use for canvas manipulation */\n\t        this.canvasWrapper = canvasWrapper;\n\t        /** coords for the elements of the arrow */\n\t        this.arrow = this.canvas = this.start = this.end = undefined;\n\t        /** options */\n\t        this.options = toolOptions;\n\t\n\t        var callee = this;\n\t        console.log('##### bravo');\n\t\n\t        this.eventAggregator.subscribeTo(_canvasConst2.default.TOOL.ARROW, 'ArrowTool', function () {\n\t            callee.initListeners.apply(callee, arguments);\n\t        });\n\t        /** shorthand to canvas */\n\t        this.canvas = canvasWrapper.canvas;\n\t\n\t        this.moveFn = function (options) {\n\t            callee.onMove(options);\n\t        };\n\t        this.downFn = function (options) {\n\t            callee.onMouseDown(options);\n\t        };\n\t        this.upFn = function (options) {\n\t            callee.onMUP(options);\n\t        };\n\t        this.notify = function (message) {\n\t            this.eventAggregator.notify('TOOL_USAGE', _canvasConst2.default.TOOL.ARROW, message);\n\t        };\n\t\n\t        this.done = function () {\n\t            this.canvasWrapper.enableSelection(true);\n\t            this.removeCanvasListeners();\n\t            this.notify('inactive');\n\t        };\n\t        console.log('##### charlie');\n\t    }\n\t\n\t    /**\n\t     * Move the head of the arrow.\n\t     * Cred for http://stackoverflow.com/questions/29890294/arrow-shape-using-fabricjs\n\t     * @private\n\t     * @param {Object} points - 4d.\n\t     */\n\t\n\t\n\t    _createClass(ArrowTool, [{\n\t        key: 'moveArrowIndicator',\n\t        value: function moveArrowIndicator(points) {\n\t            var x1 = points[0],\n\t                y1 = points[1],\n\t                x2 = points[2],\n\t                y2 = points[3],\n\t                dx = x2 - x1,\n\t                dy = y2 - y1,\n\t                angle = Math.atan2(dy, dx);\n\t\n\t            angle *= 180 / Math.PI;\n\t            angle += 90;\n\t            if (this.arrow) {\n\t                this.canvas.remove(this.arrow);\n\t            }\n\t            this.arrow = new fabric.Triangle({\n\t                angle: angle,\n\t                fill: this.options.activeColor,\n\t                top: y2,\n\t                left: x2,\n\t                height: indicationLength,\n\t                width: indicationLength,\n\t                originX: 'center',\n\t                originY: 'center',\n\t                selectable: false\n\t            });\n\t\n\t            this.canvas.add(this.arrow);\n\t        }\n\t\n\t        /**\n\t         * Cancels this paint operation, i.e. removes any ongoing paint-objects och de-registers listeners.\n\t         * @private\n\t         */\n\t\n\t    }, {\n\t        key: 'abort',\n\t        value: function abort() {\n\t            if (this.arrow) {\n\t                this.canvas.remove(this.arrow);\n\t                this.arrow = undefined;\n\t            }\n\t            if (line) {\n\t                this.canvas.remove(line);\n\t                line = undefined;\n\t            }\n\t            this.eventAggregator.unsubscribeTo('keydown', 'ArrowTool');\n\t            this.done();\n\t        }\n\t\n\t        /**\n\t         * Function callback, invoked when mouse moves, even before mouse has been pressed.\n\t         * @private\n\t         * @param {Object} options - for the event.\n\t         */\n\t\n\t    }, {\n\t        key: 'onMove',\n\t        value: function onMove(options) {\n\t\n\t            if (this.start && !this.end) {\n\t                var pointer = this.canvas.getPointer(options.e);\n\t\n\t                line.set({\n\t                    'x2': pointer.x\n\t                });\n\t                line.set({\n\t                    'y2': pointer.y\n\t                });\n\t\n\t                this.moveArrowIndicator([this.start.left, this.start.top, pointer.x, pointer.y]);\n\t            }\n\t\n\t            this.canvas.renderAll();\n\t        }\n\t\n\t        /**\n\t         * Function callback, invoked on mouse up.\n\t         * @private\n\t         * @param {Object} options - for the event.\n\t         */\n\t\n\t    }, {\n\t        key: 'onMUP',\n\t        value: function onMUP(options) {\n\t            var pointer = this.canvas.getPointer(options.e);\n\t            this.end = {\n\t                top: pointer.y,\n\t                left: pointer.x\n\t            };\n\t\n\t            var perimeter = Math.abs(this.end.top - this.start.top) + Math.abs(this.end.left - this.start.left);\n\t\n\t            if (perimeter > 10) {\n\t                if (this.arrow) {\n\t                    this.arrow.fill = this.options.color;\n\t                }\n\t                var group = new fabric.Group([line, this.arrow], {\n\t                    hasControls: false,\n\t                    hasBorders: true,\n\t                    selectable: false,\n\t                    fill: this.options.color\n\t                });\n\t                line.stroke = this.options.color;\n\t\n\t                this.canvas.add(group);\n\t            }\n\t\n\t            this.canvas.remove(line);\n\t            this.canvas.remove(this.arrow);\n\t            this.arrow = line = this.start = this.end = undefined;\n\t            this.canvas.renderAll();\n\t        }\n\t\n\t        /**\n\t         * Function callback, invoked on mouse down.\n\t         * @private\n\t         * @param {Object} options - for the event.\n\t         */\n\t\n\t    }, {\n\t        key: 'onMouseDown',\n\t        value: function onMouseDown(options) {\n\t            var pointer = this.canvas.getPointer(options.e);\n\t            this.start = {\n\t                top: pointer.y,\n\t                left: pointer.x\n\t            };\n\t\n\t            line = new fabric.Line([this.start.left, this.start.top, this.start.left, this.start.top], {\n\t                strokeWidth: 5,\n\t                stroke: this.options.activeColor,\n\t                originX: 'center',\n\t                originY: 'center',\n\t                hasControls: false,\n\t                hasBorders: true,\n\t                selectable: true\n\t            });\n\t\n\t            this.canvas.add(line);\n\t        }\n\t\n\t        /**\n\t         * Function callback, invoked when toolbar is clicked.\n\t         * @private\n\t         * @param {string} topic - .\n\t         * @param {string} sender - .\n\t         * @param {string} payload - value shold be \"toolbar-deactivate\" if tool is active.\n\t         */\n\t\n\t    }, {\n\t        key: 'initListeners',\n\t        value: function initListeners(topic, sender, payload) {\n\t            if (payload === 'toolbar-deactivate') {\n\t                this.abort();\n\t                return;\n\t            }\n\t            var me = this;\n\t\n\t            this.eventAggregator.subscribeTo('keydown', 'ArrowTool', function (topic, sender, keyCode) {\n\t\n\t                if (keyCode === 27) {\n\t                    me.abort.apply(me);\n\t                }\n\t            });\n\t            this.start = this.end = undefined;\n\t\n\t            this.canvasWrapper.enableSelection(false);\n\t\n\t            this.notify('active');\n\t\n\t            this.canvas.on('mouse:down', this.downFn);\n\t            this.canvas.on('mouse:move', this.moveFn);\n\t            this.canvas.on('mouse:up', this.upFn);\n\t        }\n\t        /**\n\t         * Removes listeners.\n\t         * @private\n\t         */\n\t\n\t    }, {\n\t        key: 'removeCanvasListeners',\n\t        value: function removeCanvasListeners() {\n\t            this.canvas.off('mouse:down', this.downFn);\n\t            this.canvas.off('mouse:move', this.moveFn);\n\t            this.canvas.off('mouse:up', this.upFn);\n\t        }\n\t    }]);\n\t\n\t    return ArrowTool;\n\t}();\n\t/** Default options for tools initialization */\n\t\n\t\n\texports.default = ArrowTool;\n\tvar toolProps = {\n\t    label: 'Arrow',\n\t    color: _canvasConst2.default.DEFAULT_COLOR,\n\t    activeColor: '#55f'\n\t};\n\t_browserApi2.default.getFromWindow('redraw').registerTool(_canvasConst2.default.TOOL.ARROW, ArrowTool, toolProps);\n\n/***/ },\n/* 8 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _canvasConst = __webpack_require__(4);\n\t\n\tvar _canvasConst2 = _interopRequireDefault(_canvasConst);\n\t\n\tvar _browserApi = __webpack_require__(2);\n\t\n\tvar _browserApi2 = _interopRequireDefault(_browserApi);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\t/** used during drag n drop */\n\tvar rect;\n\t/**\n\t * A tool to paint boxes.\n\t */\n\t\n\tvar BoxTool =\n\t/**\n\t * Tools contructor. Is provided with canvas-wrapper and eventAggregator by contract.\n\t * @constructor\n\t * @param {Canvas} canvasWrapper - Canvas.\n\t * @param {EventAggregator} eventAggregator - Event mediator.\n\t */\n\tfunction BoxTool(canvasWrapper, eventAggregator, toolOptions) {\n\t    _classCallCheck(this, BoxTool);\n\t\n\t    eventAggregator.subscribeTo(_canvasConst2.default.TOOL.BOX, 'BoxTool', attachBoxListener);\n\t    var callbackCtx = this;\n\t    var canvas = canvasWrapper.canvas;\n\t\n\t    function notify(message) {\n\t        eventAggregator.notify('TOOL_USAGE', _canvasConst2.default.TOOL.BOX, message);\n\t    }\n\t\n\t    function done() {\n\t        notify('inactive');\n\t        detachBoxListener();\n\t        canvasWrapper.enableSelection(true);\n\t    }\n\t\n\t    function detachBoxListener() {\n\t\n\t        canvas.off('mouse:down', mouseDown);\n\t        canvas.off('mouse:move', drawBox);\n\t        canvas.off('mouse:up', drawBoxDone);\n\t\n\t        rect = undefined;\n\t        eventAggregator.unsubscribeTo('keydown', 'BoxTool');\n\t    }\n\t    var currWidth, currHeight;\n\t\n\t    function drawBox(options) {\n\t        if (rect) {\n\t            var pointer = canvas.getPointer(options.e);\n\t\n\t            currWidth = pointer.x - startLeft;\n\t            currHeight = pointer.y - startTop;\n\t\n\t            rect.set({\n\t                'width': currWidth\n\t            });\n\t            rect.set({\n\t                'height': currHeight\n\t            });\n\t            rect.setCoords();\n\t            canvas.renderAll();\n\t        }\n\t    }\n\t    function drawBoxDone(options) {\n\t        canvas.off('mouse:move', drawBox);\n\t        canvas.off('mouse:up', drawBoxDone);\n\t\n\t        if (Math.abs(currWidth) < 5 && Math.abs(currHeight) < 5) {\n\t            canvas.remove(rect);\n\t            return;\n\t        }\n\t\n\t        rect.set({ opacity: 0.5 });\n\t        canvas.renderAll();\n\t    }\n\t\n\t    var currWidth, currHeight, startTop, startLeft;\n\t\n\t    function mouseDown(options) {\n\t        var pointer = canvas.getPointer(options.e);\n\t        currWidth = currHeight = 0;\n\t\n\t        startTop = pointer.y;\n\t        startLeft = pointer.x;\n\t\n\t        rect = new fabric.Rect({\n\t            left: startLeft,\n\t            top: startTop,\n\t            width: 4,\n\t            borderColor: toolOptions.color,\n\t            height: 4,\n\t            fill: toolOptions.color,\n\t            opacity: 0.3,\n\t            hasControls: true,\n\t            hasRotatingPoint: false,\n\t            originX: 'left',\n\t            originY: 'top',\n\t            selectable: false\n\t        });\n\t\n\t        canvas.add(rect);\n\t        rect.setCoords();\n\t        canvas.renderAll();\n\t        canvas.on('mouse:move', drawBox);\n\t        canvas.on('mouse:up', drawBoxDone);\n\t    }\n\t\n\t    function attachBoxListener(topic, sender, payload) {\n\t        if (payload === 'toolbar-deactivate') {\n\t            done();\n\t            return;\n\t        }\n\t        eventAggregator.subscribeTo('keydown', 'BoxTool', function (topic, sender, keyCode) {\n\t            if (keyCode === 27) {\n\t                done();\n\t            }\n\t        }, callbackCtx);\n\t        canvasWrapper.enableSelection(false);\n\t        notify('active');\n\t\n\t        canvas.on('mouse:down', mouseDown);\n\t    }\n\t};\n\t/**\n\t * Default options.\n\t */\n\t\n\t\n\texports.default = BoxTool;\n\tvar defaultToolProps = {\n\t    label: 'Box',\n\t    color: _canvasConst2.default.DEFAULT_COLOR\n\t};\n\t\n\tnew _browserApi2.default().getFromWindow('redraw').registerTool(_canvasConst2.default.TOOL.BOX, BoxTool, defaultToolProps);\n\n/***/ },\n/* 9 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _canvasConst = __webpack_require__(4);\n\t\n\tvar _canvasConst2 = _interopRequireDefault(_canvasConst);\n\t\n\tvar _browserApi = __webpack_require__(2);\n\t\n\tvar _browserApi2 = _interopRequireDefault(_browserApi);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\t/**\n\t * A tool to pixelate areas.\n\t */\n\t\n\tvar PixelateTool =\n\t/**\n\t * Tools contructor. Is provided with canvas-wrapper and eventAggregator by contract.\n\t * @constructor\n\t * @param {Canvas} canvasWrapper - Canvas.\n\t * @param {EventAggregator} eventAggregator - Event mediator.\n\t */\n\tfunction PixelateTool(canvasWrapper, eventAggregator, toolOptions) {\n\t    _classCallCheck(this, PixelateTool);\n\t\n\t    eventAggregator.subscribeTo(_canvasConst2.default.TOOL.PIXELATE, 'PixelateTool', attachBoxListener);\n\t    var rect = void 0,\n\t        callbackCtx = this;\n\t    var startTop = void 0,\n\t        startLeft = void 0;\n\t    var canvas = canvasWrapper.canvas;\n\t\n\t    function notify(message) {\n\t        eventAggregator.notify('TOOL_USAGE', _canvasConst2.default.TOOL.PIXELATE, message);\n\t    }\n\t\n\t    function done() {\n\t        notify('inactive');\n\t        detachBoxListener();\n\t        canvasWrapper.enableSelection(true);\n\t    }\n\t\n\t    function detachBoxListener() {\n\t        canvas.off('mouse:down', mouseDown);\n\t        canvas.off('mouse:move', drawBox);\n\t        canvas.off('mouse:up', drawBoxDone);\n\t\n\t        rect = undefined;\n\t        eventAggregator.unsubscribeTo('keydown', 'PixelateTool');\n\t    }\n\t\n\t    function drawBox(options) {\n\t        if (rect) {\n\t            var pointer = canvas.getPointer(options.e);\n\t\n\t            var currWidth = pointer.x - startLeft;\n\t            var currHeight = pointer.y - startTop;\n\t\n\t            rect.set({\n\t                'width': currWidth,\n\t                'height': currHeight\n\t            });\n\t\n\t            rect.setCoords();\n\t            canvas.renderAll();\n\t        }\n\t    }\n\t\n\t    function applyFilter(index, filter, obj) {\n\t        obj.filters[index] = filter;\n\t        obj.applyFilters(canvas.renderAll.bind(canvas));\n\t    }\n\t\n\t    function drawBoxDone(options) {\n\t        canvas.off('mouse:move', drawBox);\n\t        canvas.off('mouse:up', drawBoxDone);\n\t        canvas.remove(rect);\n\t\n\t        var pointer = canvas.getPointer(options.e);\n\t        var currWidth = pointer.x - startLeft;\n\t        var currHeight = pointer.y - startTop;\n\t\n\t        if (Math.abs(currWidth) > 0 && Math.abs(currHeight) > 0) {\n\t            var pixels = canvas.getContext().getImageData(pointer.x, pointer.y, currWidth, currHeight);\n\t\n\t            var object = fabric.util.object.clone(canvasWrapper.image);\n\t\n\t            object.set({\n\t                originX: 'left',\n\t                originY: 'top',\n\t                left: 0,\n\t                top: 0,\n\t                lockMovementX: true,\n\t                lockMovementY: true\n\t            });\n\t            var x = rect;\n\t\n\t            rect.left = rect.left - object.width / 2;\n\t            rect.top = rect.top - object.height / 2;\n\t\n\t            object.clipTo = function (ctx) {\n\t                x.render(ctx);\n\t            };\n\t\n\t            var f = fabric.Image.filters;\n\t            applyFilter(0, new f.Pixelate({\n\t                blocksize: 5\n\t            }), object);\n\t\n\t            canvas.add(object);\n\t            canvas.sendToBack(object);\n\t        }\n\t        canvas.renderAll();\n\t\n\t        rect = undefined;\n\t    }\n\t\n\t    function mouseDown(options) {\n\t        var pointer = canvas.getPointer(options.e);\n\t\n\t        startTop = pointer.y;\n\t        startLeft = pointer.x;\n\t\n\t        rect = new fabric.Rect({\n\t            left: startLeft,\n\t            top: startTop,\n\t            width: 4,\n\t            borderColor: toolOptions.color,\n\t            height: 4,\n\t            fill: toolOptions.color,\n\t            opacity: 0.3,\n\t            hasControls: true,\n\t            hasRotatingPoint: false,\n\t            originX: 'left',\n\t            originY: 'top',\n\t            selectable: false\n\t        });\n\t\n\t        canvas.add(rect);\n\t        rect.setCoords();\n\t        canvas.renderAll();\n\t        canvas.on('mouse:move', drawBox);\n\t        canvas.on('mouse:up', drawBoxDone);\n\t    }\n\t\n\t    function attachBoxListener(topic, sender, payload) {\n\t        if (payload === 'toolbar-deactivate') {\n\t            done();\n\t            return;\n\t        }\n\t        eventAggregator.subscribeTo('keydown', 'PixelateTool', function (topic, sender, keyCode) {\n\t            if (keyCode === 27) {\n\t                done();\n\t            }\n\t        }, callbackCtx);\n\t        canvasWrapper.enableSelection(false);\n\t        notify('active');\n\t\n\t        canvas.on('mouse:down', mouseDown);\n\t    }\n\t};\n\t/**\n\t * Default options.\n\t */\n\t\n\t\n\texports.default = PixelateTool;\n\tvar defaultToolProps = {\n\t    label: 'Pixelate',\n\t    color: _canvasConst2.default.DEFAULT_COLOR\n\t};\n\t\n\tnew _browserApi2.default().getFromWindow('redraw').registerTool(_canvasConst2.default.TOOL.PIXELATE, PixelateTool, defaultToolProps);\n\n/***/ },\n/* 10 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t\tvalue: true\n\t});\n\t\n\tvar _canvasConst = __webpack_require__(4);\n\t\n\tvar _canvasConst2 = _interopRequireDefault(_canvasConst);\n\t\n\tvar _browserApi = __webpack_require__(2);\n\t\n\tvar _browserApi2 = _interopRequireDefault(_browserApi);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\t/**\n\t * A tool to reset the canvas, i.e. remove all objects.\n\t */\n\t\n\tvar ResetTool =\n\t/**\n\t * Tools contructor. Is provided with canvas-wrapper and eventAggregator by contract.\n\t * @constructor\n\t * @param {Canvas} canvasWrapper - Canvas.\n\t * @param {EventAggregator} eventAggregator - Event mediator.\n\t */\n\tfunction ResetTool(canvasWrapper, eventAggregator) {\n\t\t_classCallCheck(this, ResetTool);\n\t\n\t\teventAggregator.subscribeTo(_canvasConst2.default.TOOL.CLEAR, 'ResetTool', initClear);\n\t\tfunction initClear(topic, sender, payload) {\n\t\t\tif (payload !== 'toolbar-deactivate' && confirm('This will restore your image to its default state.\\nAll your modifications will be deleted.\\nDo you want to continue?')) {\n\t\t\t\tclearAllElements();\n\t\t\t}\n\t\t\teventAggregator.notify('TOOL_USAGE', _canvasConst2.default.TOOL.CLEAR, 'inactive');\n\t\t}\n\t\n\t\tfunction clearAllElements() {\n\t\t\tvar c = canvasWrapper.canvas;\n\t\t\tvar all = c.getObjects();\n\t\t\tfor (var i = all.length - 1; i >= 0; i--) {\n\t\t\t\tc.remove(all[i]);\n\t\t\t}\n\t\t}\n\t};\n\t\n\texports.default = ResetTool;\n\t\n\tvar toolProps = {\n\t\tlabel: 'Clear'\n\t};\n\t\n\tnew _browserApi2.default().getFromWindow('redraw').registerTool(_canvasConst2.default.TOOL.CLEAR, ResetTool, toolProps);\n\n/***/ },\n/* 11 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _canvasConst = __webpack_require__(4);\n\t\n\tvar _canvasConst2 = _interopRequireDefault(_canvasConst);\n\t\n\tvar _browserApi = __webpack_require__(2);\n\t\n\tvar _browserApi2 = _interopRequireDefault(_browserApi);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\t/**\n\t * A tool to create horizontal lines.\n\t */\n\t\n\tvar HorizontalLineTool =\n\t/**\n\t * Tools contructor. Is provided with canvas-wrapper and eventAggregator by contract.\n\t * @constructor\n\t * @param {Canvas} canvasWrapper - Canvas.\n\t * @param {EventAggregator} eventAggregator - Event mediator.\n\t */\n\tfunction HorizontalLineTool(canvasWrapper, eventAggregator, toolOptions) {\n\t    _classCallCheck(this, HorizontalLineTool);\n\t\n\t    var canvas = canvasWrapper.canvas;\n\t    var horizontalLine;\n\t    eventAggregator.subscribeTo(_canvasConst2.default.TOOL.HLINE, 'HorizontalLineTool', _HorizontalLineTool);\n\t\n\t    function notify(message) {\n\t        eventAggregator.notify('TOOL_USAGE', _canvasConst2.default.TOOL.HLINE, message);\n\t    }\n\t\n\t    function createHorizontalLine() {\n\t\n\t        return new fabric.Line([0, 0, canvas.width, 0], {\n\t            left: 0,\n\t            top: 1,\n\t            hasControls: false,\n\t            lockMovementX: true,\n\t            opacity: 0.7,\n\t            padding: 4,\n\t            stroke: toolOptions.color,\n\t            strokeWidth: 2\n\t        });\n\t    }\n\t\n\t    function _HorizontalLineTool(addr, sender, action) {\n\t        if (action !== 'toolbar-click') {\n\t            abort();\n\t            return;\n\t        }\n\t\n\t        notify('active');\n\t\n\t        horizontalLine = createHorizontalLine();\n\t        canvas.add(horizontalLine);\n\t\n\t        eventAggregator.subscribeTo('keydown', 'HorizontalLine', function (topic, sender, keyCode) {\n\t            if (keyCode === 27) {\n\t                abort();\n\t            }\n\t        });\n\t\n\t        function abort() {\n\t            canvas.remove(horizontalLine);\n\t            horizontalLine = undefined;\n\t            // TODO unsubscribe\n\t\n\t            detachHorizontalLineListener();\n\t            notify('inactive');\n\t        }\n\t\n\t        var onMouseMove = function onMouseMove(options) {\n\t            if (horizontalLine) {\n\t                horizontalLine.set({\n\t                    'top': canvas.getPointer(options.e).y\n\t                });\n\t\n\t                horizontalLine.setCoords();\n\t                canvas.renderAll();\n\t            }\n\t        };\n\t        canvas.on('mouse:move', onMouseMove);\n\t\n\t        var onMouseUp = function onMouseUp(options) {\n\t            horizontalLine = createHorizontalLine();\n\t            canvas.add(horizontalLine);\n\t        };\n\t        canvas.on('mouse:up', onMouseUp);\n\t\n\t        function detachHorizontalLineListener() {\n\t            canvas.off('mouse:move', onMouseMove);\n\t            canvas.off('mouse:up', onMouseUp);\n\t        }\n\t    };\n\t};\n\t\n\texports.default = HorizontalLineTool;\n\t\n\tvar toolProps = {\n\t    label: 'Limit line',\n\t    color: _canvasConst2.default.DEFAULT_COLOR,\n\t    activeColor: '#55f'\n\t};\n\t\n\tnew _browserApi2.default().getFromWindow('redraw').registerTool(_canvasConst2.default.TOOL.HLINE, HorizontalLineTool, toolProps);\n\n/***/ },\n/* 12 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _canvasConst = __webpack_require__(4);\n\t\n\tvar _canvasConst2 = _interopRequireDefault(_canvasConst);\n\t\n\tvar _browserApi = __webpack_require__(2);\n\t\n\tvar _browserApi2 = _interopRequireDefault(_browserApi);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } } /**\n\t                                                                                                                                                           * A tool to remove selected elements from canvas!\n\t                                                                                                                                                           */\n\t\n\t\n\t/**\n\t * A tool to remove selected elements from canvas.\n\t */\n\t\n\tvar RemoveTool =\n\t/**\n\t * Tools contructor. Is provided with canvas-wrapper and eventAggregator by contract.\n\t * @constructor\n\t * @param {Canvas} canvasWrapper - Canvas.\n\t * @param {EventAggregator} eventAggregator - Event mediator.\n\t */\n\tfunction RemoveTool(canvasWrapper, eventAggregator) {\n\t    _classCallCheck(this, RemoveTool);\n\t\n\t    eventAggregator.notify('tool-enabled', _canvasConst2.default.TOOL.REMOVE, false);\n\t    /**\n\t    * Called upon removal.\n\t    */\n\t    var remove = function remove() {\n\t        var c = canvasWrapper.canvas;\n\t        if (c.getActiveObject()) {\n\t            c.remove(c.getActiveObject());\n\t        }\n\t        eventAggregator.notify('TOOL_USAGE', _canvasConst2.default.TOOL.REMOVE, 'inactive');\n\t    };\n\t\n\t    eventAggregator.subscribeTo(_canvasConst2.default.TOOL.REMOVE, 'RemoveTool', remove);\n\t\n\t    eventAggregator.subscribeTo('keydown', 'RemoveTool', function (topic, sender, keyCode) {\n\t        if (keyCode === 46) {\n\t            remove();\n\t        }\n\t    });\n\t\n\t    canvasWrapper.canvas.on('object:selected', function (o) {\n\t        eventAggregator.notify('tool-enabled', _canvasConst2.default.TOOL.REMOVE, true);\n\t    });\n\t    canvasWrapper.canvas.on('selection:cleared', function (o) {\n\t        eventAggregator.notify('tool-enabled', _canvasConst2.default.TOOL.REMOVE, false);\n\t    });\n\t};\n\t\n\texports.default = RemoveTool;\n\t\n\t\n\tvar toolProps = {\n\t    label: 'Delete'\n\t};\n\t\n\t/**\n\t * Register tool at the global redraw.registerTool.\n\t */\n\tnew _browserApi2.default().getFromWindow('redraw').registerTool(_canvasConst2.default.TOOL.REMOVE, RemoveTool, toolProps);\n\n/***/ },\n/* 13 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _canvasConst = __webpack_require__(4);\n\t\n\tvar _canvasConst2 = _interopRequireDefault(_canvasConst);\n\t\n\tvar _browserApi = __webpack_require__(2);\n\t\n\tvar _browserApi2 = _interopRequireDefault(_browserApi);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar editorHeight = 30;\n\t\n\t/**\n\t * A tool to create a text editor in the canvas.\n\t */\n\t\n\tvar TextTool =\n\t/**\n\t * Tools contructor. Is provided with canvas-wrapper and eventAggregator by contract.\n\t * @constructor\n\t * @param {Canvas} canvasWrapper - Canvas.\n\t * @param {EventAggregator} eventAggregator - Event mediator.\n\t */\n\tfunction TextTool(canvasWrapper, eventAggregator, toolOptions) {\n\t    _classCallCheck(this, TextTool);\n\t\n\t    var canvas = canvasWrapper.canvas;\n\t    var editor;\n\t    eventAggregator.subscribeTo(_canvasConst2.default.TOOL.TEXT, 'TextTool', textTool);\n\t    eventAggregator.subscribeTo('keydown', 'TextTool', function (topic, sender, keyCode) {\n\t        if (keyCode === 27) {\n\t            abort();\n\t        }\n\t    });\n\t\n\t    function notify(message) {\n\t        eventAggregator.notify('TOOL_USAGE', _canvasConst2.default.TOOL.TEXT, message);\n\t    }\n\t\n\t    function abort() {\n\t        if (editor) {\n\t            canvas.remove(editor);\n\t            editor = undefined;\n\t            notify('inactive');\n\t        }\n\t    }\n\t    function textTool(topic, sender, payload) {\n\t        if (payload !== 'toolbar-click') {\n\t            abort();\n\t            return;\n\t        }\n\t        notify('active');\n\t        editor = new fabric.IText('Click to leave a comment', {\n\t            fontFamily: toolOptions.fontFamily,\n\t            fontSize: toolOptions.fontSize,\n\t            left: 100,\n\t            top: -40,\n\t            fill: toolOptions.color,\n\t            hasControls: false\n\t        });\n\t\n\t        canvas.add(editor);\n\t\n\t        var onMove = function onMove(options) {\n\t            if (editor) {\n\t                var pointer = canvas.getPointer(options.e);\n\t                editor.set({\n\t                    'top': pointer.y,\n\t                    'left': pointer.x\n\t                });\n\t                editor.setCoords();\n\t                canvas.renderAll();\n\t            }\n\t        };\n\t        canvas.on('mouse:move', onMove);\n\t\n\t        function detachTextListener() {\n\t            if (editor) {\n\t                canvas.off('mouse:move', onMove);\n\t                canvas.off('mouse:up', detachTextListener);\n\t                editor.setCoords();\n\t                editor = undefined;\n\t                canvas.renderAll();\n\t                notify('inactive');\n\t            }\n\t        }\n\t        canvas.on('mouse:up', detachTextListener);\n\t    }\n\t};\n\t\n\t/** Default options for tools initialization */\n\t\n\t\n\texports.default = TextTool;\n\tvar toolProps = {\n\t    label: 'Text',\n\t    fontFamily: 'arial',\n\t    fontSize: 18,\n\t    color: _canvasConst2.default.DEFAULT_COLOR\n\t};\n\tnew _browserApi2.default().getFromWindow('redraw').registerTool(_canvasConst2.default.TOOL.TEXT, TextTool, toolProps);\n\n/***/ }\n/******/ ])\n});\n;\n//# sourceMappingURL=chart-test.js.map"],"sourceRoot":"/source/"}